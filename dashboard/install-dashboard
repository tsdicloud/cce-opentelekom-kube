#!/bin/bash

kubectl apply -f kube-dashboard-cluster-role.yaml
kubectl apply -f https://raw.githubusercontent.com/kubernetes/dashboard/v1.10.1/src/deploy/recommended/kubernetes-dashboard.yaml

# this generates a suitable bearer token for the previously established service account
kubectl -n kube-system describe secret $(kubectl -n kube-system get secret | grep kubernetes-dashboard | awk '{print $1}')

echo "Establish an SSH tunnel to your local machine, default port 8001, then open"
echo "kubectl proxy & on your remote ssh machine you are logged in"
echo "http://localhost:8001/api/v1/namespaces/kube-system/services/https:kubernetes-dashboard:/proxy/"

eyJhbGciOiJSUzI1NiIsImtpZCI6IiJ9.eyJpc3MiOiJrdWJlcm5ldGVzL3NlcnZpY2VhY2NvdW50Iiwia3ViZXJuZXRlcy5pby9zZXJ2aWNlYWNjb3VudC9uYW1lc3BhY2UiOiJrdWJlLXN5c3RlbSIsImt1YmVybmV0ZXMuaW8vc2VydmljZWFjY291bnQvc2VjcmV0Lm5hbWUiOiJrdWJlcm5ldGVzLWRhc2hib2FyZC10b2tlbi05YnJoYiIsImt1YmVybmV0ZXMuaW8vc2VydmljZWFjY291bnQvc2VydmljZS1hY2NvdW50Lm5hbWUiOiJrdWJlcm5ldGVzLWRhc2hib2FyZCIsImt1YmVybmV0ZXMuaW8vc2VydmljZWFjY291bnQvc2VydmljZS1hY2NvdW50LnVpZCI6ImFiYWQwMjc5LWIxMjctMTFlOS05YzFjLWZhMTYzZTMwMTY4YyIsInN1YiI6InN5c3RlbTpzZXJ2aWNlYWNjb3VudDprdWJlLXN5c3RlbTprdWJlcm5ldGVzLWRhc2hib2FyZCJ9.WZn27In_OvvF5DD1F8Cr_4MS-_BL7cRl7s9v_K1T2mN_ZOzjMASjTMC3N8-JcYJVXaTEX_qhFBTLBhIoIQep6n6vKCIaJlhqrS1fGJExoXh5EkajoEzK-rSjupTBgRgpwANWVpBexxEI8bw3s2XWaznDiuThmT8wMp-yPSDaOI_3HtCxmLbqBCf5xlj37nJ7V5vyesRtJYzQLwhEeW5re0ChDUP08W2D4qarFfi2dBfwBRxio1OqKCIC8co9j5AcFO9qj_gUjUUGAd43FCiHAEmbXo2M51y1RKexhFrrx9-3Bzy_Yr8qKGbniftsX9fSLUOYMwZanlP1-N8NROREDA